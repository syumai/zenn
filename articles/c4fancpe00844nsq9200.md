---
title: "フラグ付きのGo 1.17でGenericsはどこまで動くのか"
emoji: "️🍄"
type: "tech"
topics: ["go", "プログラミング"]
published: false
---

本記事は[Go 1.17 リリースパーティー](https://gocon.connpass.com/event/216361/)にて発表した内容を文書化したものです。

# Go 1.17リリース

2021年8月16日、[Go 1.17](https://go.dev/blog/go1.17)がリリースされました。

Go 1.17のリリースノートには、Genericsの関連機能について記載されておらず、正式なリリース内容としては含まれていないと言う話でした。

## なんと、Go 1.17 RC1でも一部Genericsが動いていた


## Go 1.17のリリース後に同じフラグ付きで実行したらなんと動いた


これで動きます

```sh
go install golang.org/dl/go1.17@latest
go1.17 download
go1.17 run -gcflags="-G=3" main.go
```


## どこまで動くか試してみる


## 確認したいもの

1. Type Parameters
   - 型宣言
   - 関数宣言
   - 型推論
2. Interface
   - 事前宣言されたconstraints
     - any, comparable
   - type list (type sets proposalで廃止)
   - type set
3. 標準package
   - constraints
   - slices
   - maps


## 注意

* 簡単に試しただけの内容なので、正確でない可能性があります
* 動くからといって、業務に使うと今後の仕様変更で動かなくなる可能性が高いです


## Interface => 標準package => Type Parameters の順で検証します


### Interface
  - 事前宣言されたconstraints
    - any, comparable
  - type list (type sets proposalで廃止)
  - type set


### 標準package
  - constraints
  - slices
  - maps


### Type Parameters
  - 型宣言
  - 関数宣言
  - 型推論
    - Function type inference
    - Constraint type inference


# 結果


## 仕様としては古いものの、それなりに動いた


# おまけ


## Genericsの開発branchの内容がmasterにマージされたらしい


これで最新のmasterの実装内容が動きます

```sh
go install golang.org/dl/gotip@latest
gotip download # masterをdownloadしてくれる
GOEXPERIMENT=unified gotip run main.go
```

`GOEXPERIMENT=unified` はzcheeさんに教えてもらったtenntennさんに教えてもらいました


## 最新のmasterではtype setも動きました！


